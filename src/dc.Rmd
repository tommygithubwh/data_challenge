---
title: "Data challenge code project"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# install packages if not previously installed and load these
```{r results='hide', message=FALSE, warning=FALSE}
packages <- c("dplyr", "stringr", "tidyr", "ggplot2", "grid", "gridExtra", "ggpubr", "lubridate",
              "maps", "mapdata", "maptools", "rgdal", "ggmap", "rgeos", "broom", "plyr")
install.packages(setdiff(packages, rownames(installed.packages())))
lapply(packages, library, character.only = TRUE, quietly = TRUE)
rm(packages)
```

#Load the shapefile
shapefile <- readOGR(dsn="/Map shapefiles", layer="Local_Administrative_Units_Level_1_December_2015_Full_Clipped_Boundaries_in_England_and_Wales")
#Reshape for ggplot2 using the Broom package
mapdata <- tidy(shapefile, region="lau115nm")

###Descriptive statistics and exploratory analysis
```{r}
#load files - change the path if needed
ep_by_drugs_region <- read.csv("data/Epilepsy_Drugs_By_Region.csv", sep = ",")
dim(ep_by_drugs_region)
colnames(ep_by_drugs_region)
#summary(ep_by_drugs_region)

ep_prevalence_icb <- read.csv("data/Epilepsy_Prevalence_By_ICB.csv", sep = ",")
dim(ep_prevalence_icb)
colnames(ep_prevalence_icb)
#summary(ep_prevalence_icb)

ep_prevalence_ccg <- read.csv("data/Epilepsy_Prevalence_By_CCG.csv", sep = ",")
dim(ep_prevalence_ccg)
colnames(ep_prevalence_ccg)
#summary(ep_prevalence_ccg)

```
#Create a heatmap (CCG based, England only so far). It can be used for any data in our.csv.
#For example to display prevalence in ep_prevalence_ccg.csv
```{r}
shapefile <- readOGR("data/ccg", "Clinical_Commissioning_Groups_April_2020_FEB_EN")
```
```{r}
mapdata <- tidy(shapefile)
gg <- ggplot() + geom_polygon(data = mapdata, aes(x = long, y = lat, group = group), color = "#FFFFFF", size = 0.25)
gg <- gg + coord_fixed(1)
print(gg)
```

